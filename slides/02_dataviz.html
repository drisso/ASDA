<!DOCTYPE html>
<html lang="en"><head>
<script src="02_dataviz_files/libs/clipboard/clipboard.min.js"></script>
<script src="02_dataviz_files/libs/quarto-html/tabby.min.js"></script>
<script src="02_dataviz_files/libs/quarto-html/popper.min.js"></script>
<script src="02_dataviz_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="02_dataviz_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="02_dataviz_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="02_dataviz_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Davide Risso">
  <title>Data visualization</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="02_dataviz_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="02_dataviz_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="02_dataviz_files/libs/revealjs/dist/theme/quarto-bbe7401fe57d4b791b917637bb662036.css">
  <link href="02_dataviz_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="02_dataviz_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="02_dataviz_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="02_dataviz_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Data visualization</h1>
  <p class="subtitle">Advanced Statistics and Data Analysis</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Davide Risso 
</div>
</div>
</div>

</section>
<section>
<section id="introduction" class="title-slide slide level1 center">
<h1>Introduction</h1>

</section>
<section id="what-is-statistics" class="slide level2">
<h2>What is statistics</h2>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>Statistics is the <em>art of making numerical conjectures</em> about puzzling questions.</p>
<p>Freedman et al., 1978.</p>
</div>
</div>
</div>
<div class="fragment">
<p>Statistics is the art and science of designing studies and analyzing the data that those studies produce.</p>
</div>
<div class="fragment">
<p>Its ultimate goal is translating data into knowledge and understanding of the world around us.</p>
</div>
<div class="fragment">
<p>In short, statistics is the art and science of learning from data.</p>
</div>
</section>
<section id="the-role-of-statistics" class="slide level2">
<h2>The role of statistics</h2>
<ul>
<li><strong>Design</strong>: planning how to obtain data to answer the questions of interest.</li>
<li><strong>Description</strong>: summarizing the data that are obtained.</li>
<li><strong>Inference</strong>: making decisions and predictions based on the data.</li>
</ul>
</section>
<section id="sample-and-population" class="slide level2">
<h2>Sample and population</h2>
<p>The <strong>population</strong> is the set of subjects in which we are interested.</p>
<p>The <strong>sample</strong> is the subset of the population for whom we have (or plan to have) data.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Examples:</strong></p>
</div>
<div class="callout-content">
<ul>
<li>Consumi Delle Famiglie (ISTAT). Sample: 28.000 families in all cities; population: all Italian families.</li>
<li>IPSOS exit polls. Sample: 1000 electors, population: all Italian relevant voters.</li>
<li>A census is a complete enumeration.</li>
</ul>
</div>
</div>
</div>
</section>
<section id="descriptive-and-inferential-statistics" class="slide level2">
<h2>Descriptive and Inferential Statistics</h2>
<p><strong>Descriptive statistics</strong> refers to methods for summarizing the data. The summaries usually consist of graphs and numbers such as averages and percentages.</p>
<div class="fragment">
<p><strong>Inferential statistics</strong> refers to methods for making predictions or decisions about a population, based on data obtained from a sample of that population.</p>
</div>
<div class="fragment">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Example: confidence intervals</strong></p>
</div>
<div class="callout-content">
<p>Of 834 people in a survey, 54.0<span class="math inline">\(\%\)</span> say they favor handgun control. Using statistical methods, we infer that there is 95<span class="math inline">\(\%\)</span> confidence that the true proportion is between 50.6<span class="math inline">\(\%\)</span> and 57.4<span class="math inline">\(\%\)</span>.</p>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="graphical-and-numerical-summaries" class="title-slide slide level1 center">
<h1>Graphical and numerical summaries</h1>

</section>
<section id="data" class="slide level2">
<h2>Data</h2>
<p>The <em>data</em> consist of one or more <em>variables</em> measured/recorded on <em>observational units</em> in a <em>population</em> (cf.&nbsp;census) or <em>sample</em> of the population of interest.</p>
<p>The term <em>variable</em> refers to characteristics that differ among observational units.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  country     continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779.
2 Afghanistan Asia       1957    30.3  9240934      821.
3 Afghanistan Asia       1962    32.0 10267083      853.
4 Afghanistan Asia       1967    34.0 11537966      836.
5 Afghanistan Asia       1972    36.1 13079460      740.
6 Afghanistan Asia       1977    38.4 14880372      786.</code></pre>
</div>
</div>
</section>
<section id="variables" class="slide level2">
<h2>Variables</h2>
<p>We usually distinguish the following two main types of variables.</p>
<ul>
<li>Quantitative / Numerical.</li>
<li>Qualitative / Categorical.</li>
</ul>
</section>
<section id="quantitative-variables" class="slide level2">
<h2>Quantitative Variables</h2>
<p>Quantitative variables can be</p>
<ul>
<li><em>Continuous</em> (cf.&nbsp;real numbers): any value corresponding to the points in an interval. E.g. blood pressure, height.</li>
<li><em>Discrete</em> (cf.&nbsp;integers): countable number of values. E.g. number of events per year.</li>
</ul>
</section>
<section id="qualitative-variables" class="slide level2">
<h2>Qualitative variables</h2>
<p>Qualitative variables can be</p>
<ul>
<li><em>Nominal</em>: names or labels, no natural order. E.g. Sex, ethnicity, eye color</li>
<li><em>Ordinal</em>: ordered categories, no natural numerical scale. E.g. Muscle tone, tumor grade.</li>
</ul>
</section>
<section id="tidy-data" class="slide level2">
<h2>Tidy data</h2>
<p>The concept of tidy data was introduced by Hadley Wickham in his seminal paper (Wickham, 2014).</p>
<div class="fragment">
<p>There are three fundamental rules which make a dataset tidy:</p>
<ol type="1">
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have its own cell.</li>
</ol>
</div>
<div class="fragment">
<p>The advantage of tidy data is both conceptual and practical: it allows to have consistency between datasets and to use tools designed for this data structure.</p>
</div>
</section>
<section id="distribution" class="slide level2 smaller">
<h2>Distribution</h2>
<p>The term <em>distribution</em> refers to the <em>frequencies</em> of one or more (quantitative or qualitative) <em>variables</em> recorded on units in a population or sample of interest.</p>
<div class="fragment">
<p>A <em>distribution table</em> is a table of</p>
<ul>
<li><em>absolute frequencies</em> (i.e., counts) or</li>
<li><em>relative frequencies</em> (i.e., percentages)</li>
</ul>
<p>for the values taken on by the variable(s) in the group of interest.</p>
</div>
<div class="fragment">
<p><em>Population distribution</em>:</p>
<ul>
<li>distribution of variables for units in a population;</li>
<li><em>population parameters</em>: functions, i.e., summaries, of the population distribution.</li>
</ul>
</div>
<div class="fragment">
<p><em>Empirical/Sample distribution</em>:</p>
<ul>
<li>distribution of variables for units in a sample;</li>
<li><em>sample statistics</em>: functions, i.e., summaries, of the empirical distribution.</li>
</ul>
</div>
</section>
<section id="example-life-expectancy" class="slide level2">
<h2>Example: life expectancy</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a>gapminder</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# ℹ 1,694 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="fu">summary</span>(gapminder<span class="sc">$</span>lifeExp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  23.60   48.20   60.71   59.47   70.85   82.60 </code></pre>
</div>
</div>
</section>
<section id="numerical-and-graphical-summaries" class="slide level2">
<h2>Numerical and graphical summaries</h2>
<p>As illustrated by the previous example, it is often more informative to provide a <em>summary</em> of the data rather than to look at all of them.</p>
<div class="fragment">
<p>Data summaries can be either numerical or graphical and allow us to:</p>
<ul>
<li>Focus on the <em>main characteristics</em> of the data.</li>
<li>Reveal <em>unusual features</em> of the data.</li>
<li>Summarize <em>relationship between variables</em>.</li>
</ul>
</div>
</section>
<section id="when-do-we-need-summaries" class="slide level2">
<h2>When do we need summaries?</h2>
<div>
<ul>
<li class="fragment"><strong>Exploration</strong>: to help you better understand and discover hidden patterns in the data.</li>
<li class="fragment"><strong>Explanation</strong>: to communicate insights to others.</li>
</ul>
</div>
</section>
<section id="exploratory-data-analysis-eda" class="slide level2">
<h2>Exploratory Data Analysis (EDA)</h2>
<p><em>Exploratory Data Analysis</em> (EDA) is a key step of any data analysis and of statistical practice in general.</p>
<div class="fragment">
<p>Before formally modeling the data, the dataset must be examined to get a “first impression” of the data and to reveal expected and unexpected characteristics of the data.</p>
</div>
<div class="fragment">
<p>It is also useful to examine the data for outlying observations and to check the plausibility of the assumptions of candidate statistical models.</p>
</div>
</section>
<section id="communication-of-the-results" class="slide level2">
<h2>Communication of the results</h2>
<p><em>Explanatory plots</em> (and tables) are equally important. They are often done at the end of the analysis to communicate the results to others.</p>
<div class="fragment">
<p>The main goal is to communicate your main findings:</p>
<ul>
<li>focus the attention on the important part of the plot</li>
<li>make it easy to understand the information (colors, labels)</li>
</ul>
</div>
</section>
<section id="combining-accuracy-with-aesthetics" class="slide level2">
<h2>Combining accuracy with aesthetics</h2>
<p>A good visualization should be aesthetically pleasing.</p>
<p>However, the most important aspect of data visualization is <strong>accuracy</strong>: a graph should never be misleading and aesthetics should never come at the price of inaccuracy.</p>
</section></section>
<section>
<section id="how-to-visualize-data" class="title-slide slide level1 center">
<h1>How to visualize data</h1>

</section>
<section id="a-first-example" class="slide level2">
<h2>A first example</h2>
<p>Suppose that a bakery produces five different types of pie and that the sales of these pies in the last three months were:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Type</th>
<th>October</th>
<th>November</th>
<th>December</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Apple</td>
<td>75</td>
<td>90</td>
<td>98</td>
</tr>
<tr class="even">
<td>Cherry</td>
<td>45</td>
<td>51</td>
<td>67</td>
</tr>
<tr class="odd">
<td>Blueberry</td>
<td>20</td>
<td>30</td>
<td>45</td>
</tr>
<tr class="even">
<td>Cream</td>
<td>90</td>
<td>89</td>
<td>96</td>
</tr>
<tr class="odd">
<td>Pumpkin</td>
<td>22</td>
<td>100</td>
<td>20</td>
</tr>
</tbody>
</table>
</section>
<section id="a-bad-plot" class="slide level2">
<h2>A bad plot</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"></section>
<section id="a-differently-bad-plot" class="slide level2">
<h2>A differently bad plot</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section>
<section id="a-better-plot" class="slide level2">
<h2>A better plot</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="a-better-plot-1" class="slide level2">
<h2>A better plot</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="a-plot-that-chooses-what-to-highlight" class="slide level2">
<h2>A plot that chooses what to highlight</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch"></section>
<section id="the-grammar-of-graphics" class="slide level2">
<h2>The Grammar of Graphics</h2>
<ul>
<li><strong>Aesthethics</strong> (<code>aes()</code>): translates the data into the <em>position</em>, <em>shape</em>, <em>size</em>, <em>color</em>, and <em>type</em> of the elements of a plot.</li>
</ul>
<div class="fragment">
<ul>
<li><strong>Geometry</strong> (<code>geom_*()</code>): selects the type of plot that will be displayed, e.g., lines, points, bars or heatmaps.</li>
</ul>
</div>
</section>
<section id="the-grammar-of-graphics-ggplot2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">The Grammar of Graphics (<code>ggplot2</code>)</h2>
<p>In R, the <a href="https://ggplot2-book.org/"><code>ggplot2</code></a> package allows you to translate the theory into practice.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb6-1" class="hljs-ln-code"><a href=""></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> sales, <span class="at">color =</span> month))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-grammar-of-graphics-ggplot2-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">The Grammar of Graphics (<code>ggplot2</code>)</h2>
<p>In R, the <a href="https://ggplot2-book.org/"><code>ggplot2</code></a> package allows you to translate the theory into practice.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb7-1" class="hljs-ln-code"><a href=""></a><span class="fu">ggplot</span>(df_long, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> sales, <span class="at">color =</span> month)) <span class="sc">+</span></span>
<span id="cb7-2" class="hljs-ln-code"><a href=""></a>    <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-9-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="visualizing-distributions" class="title-slide slide level1 center">
<h1>Visualizing distributions</h1>

</section>
<section id="visualizing-distributions-1" class="slide level2">
<h2>Visualizing distributions</h2>
<p>Often, we want to understand what is the empirical distribution of a variable in a dataset.</p>
<div class="fragment">
<p>Perhaps we want to understand if the Gaussian distribution is a good approximation for our data, or we want to see whether the observations that we collected are uniform across age groups, etc.</p>
</div>
<div class="fragment">
<p>In this case, we need a way to <strong>estimate</strong> the variable’s distribution and then visualize it.</p>
</div>
<div class="fragment">
<p>For the univariate case, the two most popular choices are <em>histograms</em> and <em>kernel density estimates</em>.</p>
</div>
</section>
<section id="histograms" class="slide level2 smaller">
<h2>Histograms</h2>
<p>A <em>histogram</em> is used to display numerical variables, by aggregating similar values into “bins” to represent the distribution.</p>
<div class="fragment">
<p>This can be easily done with the following steps:</p>
<ol type="1">
<li>Partition the real line into intervals (<em>bins</em>).</li>
<li>Assign each observation to its bin depending on its numerical value.</li>
<li>Possibly scale the height of the bins so that the total area of the histogram is 100%</li>
</ol>
</div>
<div class="fragment">
<p>Step 3 ensures that the area of each bin represents the percentage of observations in that block.</p>
</div>
</section>
<section id="example-life-expectancy-1" class="slide level2">
<h2>Example: Life expectancy</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section id="how-to-choose-the-bins" class="slide level2">
<h2>How to choose the bins</h2>
<p>The histogram representation of the data depends on two critical choices:</p>
<ul>
<li>The number of bins / the bin width</li>
<li>The location of the bin boundaries.</li>
</ul>
<div class="fragment">
<p>Note that the number of bins in the histogram controls the amount of information loss: <em>the larger the bin width the more information we lose</em>.</p>
</div>
</section>
<section id="example-life-expectancy-2" class="slide level2">
<h2>Example: Life expectancy</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="density-plots" class="slide level2">
<h2>Density Plots</h2>
<p>Density plots are smoothed versions of histograms, obtained using <em>kernel density estimation</em> methods.</p>
</section>
<section id="density-plots-1" class="slide level2">
<h2>Density Plots</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="density-plots-2" class="slide level2">
<h2>Density Plots</h2>
<p>The choice of <em>bandwidth</em>, similarly to the number of bins in a histogram, determines the smoothness of the density.</p>
<p>There is a <em>bias-variance trade-off</em> in the choice of the bandwidth:</p>
<ul>
<li>the larger the bandwidth, the smoother the density (low variance, high bias)</li>
<li>the smaller the bandwidth, the less smooth (high variance, low bias)</li>
</ul>
</section>
<section id="density-plots-3" class="slide level2">
<h2>Density Plots</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="density-plots-4" class="slide level2">
<h2>Density Plots</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-14-1.png" width="960" class="r-stretch"></section>
<section id="density-plots-5" class="slide level2">
<h2>Density Plots</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="density-plots-6" class="slide level2">
<h2>Density Plots</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-16-1.png" width="960" class="r-stretch"></section>
<section id="density-plots-7" class="slide level2">
<h2>Density Plots</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-17-1.png" width="960" class="r-stretch"></section>
<section id="numerical-summaries-of-one-variable" class="slide level2">
<h2>Numerical Summaries of One Variable</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch"></section>
<section id="numerical-summaries-of-one-variable-1" class="slide level2">
<h2>Numerical Summaries of One Variable</h2>
<p>Can we describe the differences between these five distributions using numerical summaries?</p>
<div class="fragment">
<div>
<ol type="1">
<li class="fragment"><em>Location</em>: what is the “most common” value of the distribution?</li>
<li class="fragment"><em>Scale</em>: how concentrated are the values aroung the average?</li>
<li class="fragment"><em>Shape</em>: what is the shape of the distribution?</li>
</ol>
</div>
</div>
</section>
<section id="location-mean-and-median" class="slide level2 smaller">
<h2>Location: Mean and Median</h2>
<p>The first numerical summary relates to the location of the distribution.</p>
<p>The simplest summary is the (arithmetic) <em>mean</em>.</p>
<p>Given a list of <span class="math inline">\(n\)</span> numbers, <span class="math inline">\(\{x_1, \ldots, x_n\}\)</span></p>
<p><span class="math display">\[
\bar{x} = \frac{\sum_{i=1}^n x_i}{n}.
\]</span></p>
<div class="fragment">
<p>A <em>robust alternative</em> is the <em>median</em>, which is simply the central observation. One can simply compute the median by ordering the observations and selecting the one that falls in the middle.</p>
<p>The <em>median</em> is a <em>robust summary</em>, in the sense that it is less influence by extreme values.</p>
</div>
</section>
<section id="example-mean-vs-median" class="slide level2">
<h2>Example: Mean vs Median</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb8-2"><a href=""></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="fu">median</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">100</span>)</span>
<span id="cb12-2"><a href=""></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="fu">median</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.5</code></pre>
</div>
</div>
</section>
<section id="example-location-of-the-five-distributions" class="slide level2">
<h2>Example: Location of the five distributions</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-20-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p>The means of the five distributions are: 0, <span style="color:#DF536B">5</span>, <span style="color:#61D04F">0</span>, <span style="color:#2297E6">0</span>, <span style="color:#28E2E5">0</span>.</p>
</section>
<section id="scale-standard-deviation-and-variance" class="slide level2 smaller">
<h2>Scale: Standard Deviation and Variance</h2>
<p>The <em>standard deviation</em> (SD) measures the <em>spread</em> or <em>scale</em> of a distribution.</p>
<p>It is defined as</p>
<p><span class="math display">\[
s_x = \sqrt{\frac{\sum_{i=1}^n (x_i - \bar{x})^2}{n -1}}.
\]</span></p>
<p>The <em>variance</em> is the square of the standard deviation.</p>
<div class="fragment">
<p>If the data are approximately normally distributed, roughly 68% of the observations are within one SD of the mean and 95% within two SD.</p>
</div>
</section>
<section id="scale-robust-alternatives" class="slide level2">
<h2>Scale: Robust Alternatives</h2>
<p>Similarly to the median for the mean, there are robust summaries to describe the scale of the distribution.</p>
<div class="fragment">
<p>The <em>inter-quartile range</em> (IQR) is the difference between the upper- and lower-quartile, i.e., the observation that has <span class="math inline">\(75\%\)</span> of the data below it and the observation that has <span class="math inline">\(25\%\)</span> of the observations below it, respectively.</p>
</div>
<div class="fragment">
<p>The <em>median absolute deviation</em> (MAD) is the median of the absolute deviations from the median:</p>
<p><span class="math display">\[
MAD_x = \text{median}( | x_i - M_x |)
\]</span> where <span class="math inline">\(M_x\)</span> is the median of <span class="math inline">\(\{x_1, \ldots, x_n\}\)</span>.</p>
</div>
</section>
<section id="quantiles" class="slide level2">
<h2>Quantiles</h2>
<p>The median, upper-quartile, and lower-quartile are examples of <em>quantiles</em>.</p>
<div class="fragment">
<p>More formally, the <span class="math inline">\(f\)</span> <em>quantile</em> or <span class="math inline">\(f\times 100\)</span>th <em>percentile</em> of a distribution is the smallest number <span class="math inline">\(q\)</span> such that at least <span class="math inline">\(f \times 100\)</span>% of the observations are less than or equal to <span class="math inline">\(q\)</span>.</p>
</div>
<div class="fragment">
<p>In other words, <span class="math inline">\(f\times 100\)</span>% of the area under the histogram is to the left of the <span class="math inline">\(f\)</span> quantile.</p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Quartiles</strong></p>
</div>
<div class="callout-content">
<table class="caption-top">
<tbody>
<tr class="odd">
<td>First/lower quartile</td>
<td>0.25 quantile</td>
</tr>
<tr class="even">
<td>Second quartile/median</td>
<td>0.50 quantile</td>
</tr>
<tr class="odd">
<td>Third/upper quartile</td>
<td>0.75 quantile</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="the-median-as-a-quantile" class="slide level2">
<h2>The Median as a Quantile</h2>
<p>The <em>median</em> corresponds to the special case <span class="math inline">\(f=0.5\)</span>.</p>
<p>If the number of observations <span class="math inline">\(n\)</span> is <em>odd</em>, i.e., <span class="math inline">\(n=2m+1\)</span>, there will be an observation that corresponds to the median.</p>
<p>If the number of observations <span class="math inline">\(n\)</span> is <em>even</em>, i.e., <span class="math inline">\(n=2m\)</span>, we need to average the two central observations.</p>
</section>
<section id="boxplot" class="slide level2">
<h2>Boxplot</h2>
<p>The boxplot, also called <em>box-and-whisker plot</em> was first introduced by Tukey in 1977 as a graphical summary of a variable’s distribution.</p>
<p>It is a graphical representation of the median, upper and lower quartile, and the range (possibly, with outliers).</p>
</section>
<section id="boxplot-1" class="slide level2">
<h2>Boxplot</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-21-1.png" class="quarto-figure quarto-figure-center r-stretch" width="384"></section>
<section id="boxplot-2" class="slide level2">
<h2>Boxplot</h2>
<ul>
<li>The bold line represents the <em>median</em>.</li>
<li>The upper and lower sides of the box represent the lower and upper quartiles, respectively.</li>
<li>The central box represents the <em>IQR</em>.</li>
<li>The whiskers represent the range of the variable, but any point more than 1.5 IQR above the upper quartile (or below the lower quartile) are plotted individually as <em>outliers</em>.</li>
<li>Comparing the distances between the quartiles and the median gives indication of the symmetry of the distribution.</li>
</ul>
</section>
<section id="boxplots-of-the-five-distributions" class="slide level2">
<h2>Boxplots of the five distributions</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-22-1.png" width="960" class="r-stretch"></section>
<section id="pros-and-cons-of-boxplots" class="slide level2">
<h2>Pros and Cons of Boxplots</h2>
<div>
<ul>
<li class="fragment"><p>Boxplots are a great graphical tool to summarize distributions, especially when they are approximately normally distributed.</p></li>
<li class="fragment"><p>Even in the presence of strong asymmetry, the boxplot still captures the shape of the distribution.</p></li>
<li class="fragment"><p>One of the advantages of the boxplot is its effectiveness at identifying outlying observations.</p></li>
<li class="fragment"><p>However, the boxplot <em>hides multimodality</em> in the data.</p></li>
</ul>
</div>
</section>
<section id="pros-and-cons-of-boxplots-1" class="slide level2">
<h2>Pros and Cons of Boxplots</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="scale-of-the-five-distributions" class="slide level2">
<h2>Scale of the five distributions</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-24-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"><p>The standard deviations of the five distributions are: 1, <span style="color:#DF536B">1</span>, <span style="color:#61D04F">2</span>, <span style="color:#2297E6">2</span>, <span style="color:#28E2E5">2</span>.</p>
</section>
<section id="shape-of-the-five-distributions" class="slide level2">
<h2>Shape of the five distributions</h2>
<div>
<ul>
<li class="fragment"><p>Even though the green, blue, and cyan distributions have the same mean and variance, they are clearly different.</p></li>
<li class="fragment"><p>How can we capture these differences?</p></li>
<li class="fragment"><p>There are numerical summaries called <em>skewness</em> and <em>kurtosis</em>, but the most effective way is to look at graphical summaries (boxplots and histograms).</p></li>
<li class="fragment"><p>The skewness of the five distributions are: 0, <span style="color:#DF536B">0</span>, <span style="color:#61D04F">0</span>, <span style="color:#2297E6">2</span>, <span style="color:#28E2E5">0</span>.</p></li>
<li class="fragment"><p>The kurtosis of the five distributions are: 3, <span style="color:#DF536B">3</span>, <span style="color:#61D04F">3</span>, <span style="color:#2297E6">10</span>, <span style="color:#28E2E5">18</span>.</p></li>
</ul>
</div>
</section>
<section id="alternatives-to-boxplots" class="slide level2">
<h2>Alternatives to boxplots</h2>
<p>Boxplots can be used to visualize multiple distributions at once.</p>
<p>If we want to do the same using kernel density, we can use <em>violin plots</em> or <em>ridgeline plots</em>.</p>
</section>
<section id="violin-plots" class="slide level2">
<h2>Violin plots</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-25-1.png" width="960" class="r-stretch"></section>
<section id="ridgeline-plots" class="slide level2">
<h2>Ridgeline plots</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-26-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="visualizing-two-variables" class="title-slide slide level1 center">
<h1>Visualizing two variables</h1>

</section>
<section id="graphical-summaries-of-two-variables" class="slide level2">
<h2>Graphical Summaries of Two Variables</h2>
<div>
<ul>
<li class="fragment"><p>Boxplots, histograms, and density plots all summarize the univariate distribution of a single variable. But what if we want to capture the relation between variables?</p></li>
<li class="fragment"><p>The most used graphical representation of the relation between two variables is not a summary. We can simply plot <em>all the observations</em> for the two variables in a <em>scatterplot</em>.</p></li>
<li class="fragment"><p>When there are too many observations, summaries based on 2D-density estimation can be used.</p></li>
</ul>
</div>
</section>
<section id="scatterplots" class="slide level2">
<h2>Scatterplots</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-27-1.png" width="960" class="r-stretch"></section>
<section id="considerations-for-scatterplots" class="slide level2">
<h2>Considerations for scatterplots</h2>
<p>Even for this simple element, there are important considerations to make when presenting results.</p>
<div class="fragment">
<p>In fact, “stretching” one or the other axis may lead to emphasizing one aspect over others.</p>
</div>
<div class="fragment">
<p>This is particularly important in the case where the measurements of the two axes are similar and should be treated as such.</p>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Use the <code>coord_equal()</code> function in <code>ggplot2</code> to ensure equal coordinates.</p>
</div>
</div>
</div>
</div>
</section>
<section id="coordinate-systems-and-axes" class="slide level2">
<h2>Coordinate systems and axes</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-28-1.png" width="960" class="r-stretch"></section>
<section id="data-transformation" class="slide level2">
<h2>Data transformation</h2>
<p>You may have noticed that I used the logarithm of GDP per capita in the previous plot.</p>
<div class="fragment">
<p>This is because in the linear scale this variable has a skewed distribution most points are “squished” to the left, making the general trend difficult to see.</p>
</div>
<div class="fragment">
<p>Log transformation, like many data transformations, can be useful, but sometimes can create distorsions; hence, it is always good to try different scales for your data <em>in the exploratory phase</em>.</p>
</div>
</section>
<section id="example" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb16-1" class="hljs-ln-code"><a href=""></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb16-2" class="hljs-ln-code"><a href=""></a>    <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-29-1.png" width="960" class="r-stretch"></section>
<section id="example-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb17-1" class="hljs-ln-code"><a href=""></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb17-2" class="hljs-ln-code"><a href=""></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-3" class="hljs-ln-code"><a href=""></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans =</span> <span class="st">"log10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-30-1.png" width="960" class="r-stretch"></section>
<section id="avoid-overplotting" class="slide level2">
<h2>Avoid overplotting</h2>
<p>When there are too many data points, plotting every point is redundant and may cause loss of information.</p>
<p>In such cases, it is better to display the two-dimensional density of the points, either with contours or with hexagonal binning.</p>
</section>
<section id="example-2" class="slide level2 smaller">
<h2>Example</h2>
<p>Let’s have a look at an example dataset, which contains the expression of 45101 genes in two embryos.</p>
<p>Here, we are plotting tens of thousands of points, many of which are on top of each other.</p>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-32-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="example-3" class="slide level2 smaller">
<h2>Example</h2>
<p>We can estimate a 2D density and plot the density function instead of (or in addition to) the points.</p>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-33-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="example-4" class="slide level2 smaller">
<h2>Example</h2>
<p>In this case a better alternative is to use hexagonal binning of points to represent their density.</p>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-34-1.png" class="quarto-figure quarto-figure-center r-stretch" width="960"></section>
<section id="numerical-summaries-of-two-variables" class="slide level2">
<h2>Numerical Summaries of Two Variables</h2>
<p>The variance and standard deviation are summaries of the spread of the distribution of one variable.</p>
<div class="fragment">
<p>We can compute them for multiple variables, but they will not tell us anything about the relationship between two or more variables.</p>
</div>
<div class="fragment">
<p>The <em>covariance</em> can be used to assess the relation between two variables, say <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p><span class="math display">\[
Cov(x, y) = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x}) (y_i - \bar{y}).
\]</span></p>
</div>
</section>
<section id="correlation-coefficient" class="slide level2 smaller">
<h2>Correlation Coefficient</h2>
<p>The problem with the covariance is that it depends on the scale of the two variables. It is often more useful to have an absolute indication of the strength of the relation, such as an index between -1 and 1.</p>
<div class="fragment">
<p>Such an index is the <em>correlation coefficient</em>.</p>
<p>It is a measure of the <em>linear association</em> between two variables.</p>
<p><span class="math display">\[
r = Cor(x, y) = \frac{1}{n} \sum_{i=1}^n \left( \frac{x_i - \bar{x}}{s_x} \right) \left( \frac{y_i - \bar{y}}{s_y} \right)
\]</span></p>
<p>This is also called <em>Pearson correlation</em>.</p>
</div>
<div class="fragment">
<p><em>Spearman’s correlation coefficient</em> is a robust measure of correlation, where ranks are used in place of the values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
</div>
</section>
<section id="example-of-correlated-and-uncorrelated-data" class="slide level2">
<h2>Example of Correlated and Uncorrelated Data</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-35-1.png" width="960" class="r-stretch"></section>
<section id="these-patterns-are-not-captured-by-univariate-techniques" class="slide level2">
<h2>These patterns are not captured by univariate techniques</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-36-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="visualizing-more-than-two-variables" class="title-slide slide level1 center">
<h1>Visualizing more than two variables</h1>

</section>
<section id="faceting" class="slide level2">
<h2>Faceting</h2>
<p>The embryo gene expression example dataset is much more complex than what we have been looked at earlier.</p>
<p>It contains 45101 genes measured in 101 samples.</p>
<div class="fragment">
<p>In some cases, it may be useful to use <em>faceting</em> to represent a third dimension, e.g., this plot shows the relation between two genes across samples, stratified by genotype.</p>
</div>
</section>
<section id="faceting-1" class="slide level2">
<h2>Faceting</h2>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-38-1.png" width="960" class="r-stretch"></section>
<section id="heatmaps" class="slide level2 smaller">
<h2>Heatmaps</h2>
<p>Heatmaps can be used to visualize high-dimensional data.</p>

<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-39-1.png" class="quarto-figure quarto-figure-center r-stretch" width="576"></section>
<section id="dimensionality-reduction" class="slide level2 smaller">
<h2>Dimensionality reduction</h2>
<p>A smart alternative for high-dimensional data is to project the data points onto a lower-dimensional embedding, such as the space of the first principal components.</p>


<img data-src="02_dataviz_files/figure-revealjs/unnamed-chunk-40-1.png" width="960" class="r-stretch"></section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="02_dataviz_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="02_dataviz_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="02_dataviz_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="02_dataviz_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="02_dataviz_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="02_dataviz_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="02_dataviz_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="02_dataviz_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="02_dataviz_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="02_dataviz_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>